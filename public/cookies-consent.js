document.addEventListener("DOMContentLoaded",function(){u(),k(),C()});function u(){document.querySelectorAll(".accordion-button").forEach(e=>{e.removeEventListener("click",l)}),document.querySelectorAll(".accordion-button").forEach(e=>{e.addEventListener("click",l)})}function l(e){e.stopPropagation();const t=e.currentTarget;f(t)}function f(e){const t=document.querySelector(e.dataset.target);document.querySelectorAll(".accordion-collapse").forEach(o=>{if(o!==t){o.classList.remove("show");const n=document.querySelector(`[data-target="#${o.id}"]`);n&&(n.classList.add("collapsed"),window.cookies_consent_translations&&(n.textContent=window.cookies_consent_translations.read_more))}}),t.classList.contains("show")?(t.classList.remove("show"),e.classList.add("collapsed"),window.cookies_consent_translations&&(e.textContent=window.cookies_consent_translations.read_more)):(t.classList.add("show"),e.classList.remove("collapsed"),window.cookies_consent_translations&&(e.textContent=window.cookies_consent_translations.read_less))}function k(){const e=document.getElementById("cookies-consent-banner"),t=document.getElementById("scify-cookie-consent-floating-button"),o=e.dataset.showFloatingButton==="true"||e.dataset.showFloatingButton==="1",n=e.dataset.hideFloatingButtonOnMobile==="true"||e.dataset.hideFloatingButtonOnMobile==="1",i=e.dataset.cookiePrefix;let s=b(i+"cookies_consent");g(e,t,o,n,s),d(s),y({"accept-all-cookies":h,"accept-selected-cookies":p,"reject-optional-cookies":w})}function y(e){for(const[t,o]of Object.entries(e)){const n=document.getElementById(t);n&&n.addEventListener("click",o)}}function g(e,t,o,n,i){r()?e.style.display="block":m(e,t,o,n,i)}function m(e,t,o,n,i){i?(e.style.display="none",o&&t&&(t.style.display=n&&window.innerWidth<768?"none":"block")):e.style.display="block"}function d(e){if(e){const t=JSON.parse(e);for(const o in t){const n=document.getElementById(o);n&&(n.checked=t[o])}}}function h(){a(c(!0))}function p(){a(c())}function w(){a(c(!1,"strictly_necessary"))}function c(e=!1,t=null){const o={};return document.querySelectorAll(".cookie-category").forEach(n=>{o[n.id]=e||n.id===t||n.checked}),o}function a(e){const t=document.getElementById("cookies-consent-banner"),o=document.getElementById("scify-cookie-consent-floating-button"),n=t.dataset.showFloatingButton==="true"||t.dataset.showFloatingButton==="1",i=t.dataset.cookiePrefix;e.locale=t.dataset.locale,fetch(t.dataset.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(e)}).then(s=>s.json()).then(s=>{s.success&&(E(i+"cookies_consent",JSON.stringify(e),30),d(JSON.stringify(e)),r()||(t.style.display="none",n&&(o.style.display="block")),B(s.message))})}function B(e){const t=document.getElementById("scify-cookies-consent");if(t){const o=document.createElement("div");o.classList.add("cookie-success-message"),o.innerText=e,t.appendChild(o),setTimeout(()=>{o.classList.add("show")},100),setTimeout(()=>{o.classList.remove("show"),setTimeout(()=>{o.remove()},1e3)},4e3)}}function C(){const e=document.getElementById("cookie-policy-link");e&&e.addEventListener("click",function(){L("cookieConsent")})}function r(){return window.location.href.includes("/cookie-policy")}function E(e,t,o){let n="";{const i=new Date;i.setTime(i.getTime()+o*24*60*60*1e3),n="; expires="+i.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}function b(e){const t=e+"=",o=document.cookie.split(";");for(const n of o){let i=n.trim();if(i.startsWith(t))return i.substring(t.length,i.length)}return null}function L(e){document.cookie=e+"=; Max-Age=-99999999;"}window.toggleCookieBanner=function(){const e=document.getElementById("cookies-consent-banner"),t=document.getElementById("scify-cookie-consent-floating-button"),o=e.dataset.showFloatingButton==="true"||e.dataset.showFloatingButton==="1";e.style.display==="none"||e.style.display===""?(e.style.display="block",o&&(t.style.display="none")):(e.style.display="none",o&&(t.style.display="block"))};
